## Тестовое задание:
>### Вывод списка офисов через Яндекс.Карты
> 1. Через API формируем структуру инфоблоков. Написать скрипт, который можно запустить в Битрикс PHP (что бы не делать все руками)
> 2. Через API заполняем инфоблоки – (аналогично п.1., т.е. написать скрипт, который можно запустить в Битрикс PHP (что бы не делать все руками)) 5-6 записей
>    1. Название офиса
>    2. Телефон
>    3. Email
>    4. Координаты
>    5. Город
> 3. Выводим во фронте карту с офисами, при клике на офис открывается карточка с офисом (API Яндекс.Карт)
> 4. Используем кеширование, ООП, адаптивную верстку
> 5. Кладем код в github или bitbucket, открываем доступ, направляем рекрутеру ссылку и пояснение по установке и настройке (если требуется)
> 6. Важно! Весь Битрикс грузить не нужно, только то, чтобы создано/доработано и при клонировании в чистый Битрикс заработает!
     
&nbsp;

---

## Инструкция:
1. Запустить миграцию создания инфоблока офисов в Битрикс PHP (Настройки => Инструменты => Командная PHP-строка):
    ```
    CBitrixComponent::includeComponentClass("gazprom:offices");
    $component = new \Offices();
    
    $iblockId = $component->getOfficesInfoBlockId();
    
    if ($iblockId) {
        echo 'ID инфоблока: ' . $iblockId;
    } else {
        echo 'Не удалось создать инфоблок';
    }
    ```
    Либо запустить скрипт **/local/php_interface/migrations/add_offices_iblock.php** через консоль

    &nbsp;

2. Запустить миграцию заполнения инфоблока офисов в Битрикс PHP (Настройки => Инструменты => Командная PHP-строка):
    ```
    CBitrixComponent::includeComponentClass("gazprom:offices");
    $component = new \Offices();
    
    $iblockId = $component->getOfficesInfoBlockId();
    
    if ($iblockId) {
        $xml = simplexml_load_file($_SERVER['DOCUMENT_ROOT'] . '/upload/xml/offices.xml');
    
        if (!$xml) {
            echo 'Не удалось загрузить XML файл "offices.xml" из директории /upload/xml/';
        } else {
            $offices = json_decode(json_encode($xml), true)['Office'];
    
            foreach ($offices as $office) {
                $component->addOffice($office);
            }
        }
    } else {
        echo 'Инфоблок офисов отсутствует, запустите сначала миграцию создания инфоблока!';
    }
    ```
    Либо запустить скрипт **/local/php_interface/migrations/fill_offices_iblock.php** через консоль

    &nbsp;

---

## Пояснения по выполнению задания:
1. Задание было выполнено на чистой копии 1С-Битрикс в редакции Старт;
2. Все методы по работе с инфоблоком офисов вынесены в класс компонента, в реальном проекте эти методы лучше выносить в отдельный класс для работы с инфоблоками;
3. В реальном проекте миграции лучше реализовывать через модуль [Миграции для разработчиков](https://marketplace.1c-bitrix.ru/solutions/sprint.migration/).